#Example 1:
# Appying MCMC_pseudolikelihood_generic to the toy-example given in the slides
# of Mattis.
# (slides availiable at http://www.stats.ox.ac.uk/~evans/CDT/intractable.pdf for now)

#Set inputs
seedValue = 1729L
sigma_x = 1
sigma_y = 2
x_true = 0.4
y_measured = rnorm(50, mean = x_true, sd = sigma_y)
x_guess = 0
rQ = function(x){return(rnorm(1,x,2))} # Note that the proposal is symetric
dprior = function(x){return(dnorm(x,mean = x_guess, sd = sigma_x))}
testEpsilon = 0.2
testM = 50
sampleYgivenX = function(n,x){return(rnorm(n, mean = x, sd = sigma_y))}
Steps = 3000


set.seed(seed = seedValue)

#Do Simulations
X = ABC_MCMC( N_steps = Steps,
              y_obs = y_measured,
              epsilon=testEpsilon,
              m = testM,
              x_initialGuess = x_guess,
              sampleProposal = rQ,
              ddistX = dprior,
              rdistY_givenX = sampleYgivenX
              )

# Do something with the result...
summary(X)

#Plotting the result
plot(X,TRUE)